{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="Checkout Page" />
    <meta name="author" content="" />
    <title>Checkout - Responsive Design</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- Bootstrap icons-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
    <link rel="icon" type="image/x-icon" href="{% static 'assets/img/logo.jpg' %}" />
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="{% static 'css/productDetail.css' %}" rel="stylesheet" />
    <style>
        /* Basic layout styling */
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;

        }

        /* Container for checkout */
        .checkout-container {
            display: flex;
            flex-wrap: wrap;
            margin: 0 auto;
            max-width: 1200px;
            padding: 20px;
            padding-left: 0;
        }

        /* Left column for form */
        .checkout-form {
            flex: 1;
            min-width: 300px;
            padding: 20px;
            background-color: #fff;


        }

        /* Right column for cart items */
        .cart-items {
            flex: 1;
            min-width: 300px;
            padding: 20px;
            background-color: #fff;

        }

        /* Form styling */
        .checkout-form h2 {
            margin-bottom: 20px;
            font-size: 24px;
        }

        .checkout-form .form-floating {
            margin-bottom: 15px;
        }



        .checkout-form .form-floating input,
        .checkout-form .form-floating select,
        .checkout-form .form-floating textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        /* Cart items styling */
        .cart-items h2 {
            margin-bottom: 20px;
            font-size: 24px;
        }

        .cart-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #ddd;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item img {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
        }

        .cart-item-details {
            flex: 1;
            margin-left: 15px;
        }

        .cart-item-name {
            font-size: 16px;

        }

        .cart-item-price {
            font-size: 14px;
            color: #555;
        }


        /* Media query for responsive design */
        @media (max-width: 768px) {
            .checkout-container {
                flex-direction: column;
            }

            .slide-cart,
            .slide-menu {
                width: 100%;
            }

            .checkout-form,
            .cart-items {
                margin-right: 0;
                margin-bottom: 20px;
            }
        }

        .slide-menu,
        .slide-cart {
            position: fixed;
            top: 0;
            bottom: 0;
            width: 50%;
            max-width: 400px;
            background-color: #fff;

            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
            z-index: 1000;
        }

        .slide-cart {
            right: 0;
            transform: translateX(100%);
        }

        .slide-menu.active {
            transform: translateX(0);
        }

        .slide-cart.active {
            transform: translateX(0);
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 20px;
            cursor: pointer;
        }

        body {
            margin-bottom: 0px;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 1;
        }


        .slide-menu ul {
            list-style-type: none;
            padding: 0;
        }

        .slide-menu ul li {
            margin: 20px 0;
            text-align: center;
        }

        .slide-menu ul li a {
            color: black;
            text-decoration: none;

            transition: color 0.2s ease;
            line-height: 1rem;
        }





        #logo-footer {
            max-width: 20%;
            width: 33%;
        }

        footer {
            width: 100%;
        }
    </style>
    <link rel="stylesheet" href="{% static 'navbox.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
</head>
</head>

<body>
    <div class="nav-box">
        <div style="cursor: pointer;">
            <span onclick="openMenu()">
                <svg width="35px" height="35px" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6 8.1H19V6.9H6V8.1ZM6 18.1H19V16.9H6V18.1ZM6 13.1H19V11.9H6V13.1Z" fill="#121923"></path>
                </svg>
            </span>
        </div>
        <div >
            <img src="{% static 'img/logo_outline2.svg' %}" style="width: 90px; padding: 0px 10px;" alt="">
        </div>
        <div class="left-box" id="cart-icon" style="visibility: hidden;">
            <span>
                <svg fill="#000000" width="35px" height="35px" viewBox="0 0 256 256" id="Flat"
                    xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M216,68H171.81006a43.99152,43.99152,0,0,0-87.62012,0H40A12.01312,12.01312,0,0,0,28,80V208a12.01312,12.01312,0,0,0,12,12H216a12.01312,12.01312,0,0,0,12-12V80A12.01312,12.01312,0,0,0,216,68ZM128,36a36.04775,36.04775,0,0,1,35.77246,32H92.22754A36.04775,36.04775,0,0,1,128,36Zm92,172a4.004,4.004,0,0,1-4,4H40a4.004,4.004,0,0,1-4-4V80a4.004,4.004,0,0,1,4-4H84v28a4,4,0,0,0,8,0V76h72v28a4,4,0,0,0,8,0V76h44a4.004,4.004,0,0,1,4,4Z">
                    </path>
                </svg>
            </span>
        </div>
    </div>
    <!-- menu overlay -->
    <div id="menu-overlay">
        <div id="menu-slider">
            <div class="menu-header">
                <h3>Menu</h3>
    
                <svg style="cursor: pointer;" id="close-menu" width="30px" height="30px" viewBox="0 0 24 24" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path d="M7 17L16.9 7.1" stroke="#000" stroke-linecap="round" stroke-linejoin="round"></path>
                    <path d="M7 7L16.9 16.9" stroke="#000" stroke-linecap="round" stroke-linejoin="round"></path>
                </svg>
            </div>
            <ul id="menu-items">
                <li><a href="{% url 'homePage' %}">Home</a></li>
                <li><a href="{% url 'store' %}">Store</a></li>
                <li><a href="{% url 'contact' %}">Contact</a></li>
                <li><a href="{% url 'lookbook' %}">Lookbook</a></li>
    
            </ul>
            <div id="menu-footer">
                <a href="https://www.instagram.com/gullyboysclan/" target="_blank" class="social-icon">
                    <svg width="35px" height="35px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000">
                        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                        <g id="SVGRepo_iconCarrier">
                            <title>instagram [#167]</title>
                            <desc>Created with Sketch.</desc>
                            <defs> </defs>
                            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                <g id="Dribbble-Light-Preview" transform="translate(-340.000000, -7439.000000)"
                                    fill="#000000">
                                    <g id="icons" transform="translate(56.000000, 160.000000)">
                                        <path
                                            d="M289.869652,7279.12273 C288.241769,7279.19618 286.830805,7279.5942 285.691486,7280.72871 C284.548187,7281.86918 284.155147,7283.28558 284.081514,7284.89653 C284.035742,7285.90201 283.768077,7293.49818 284.544207,7295.49028 C285.067597,7296.83422 286.098457,7297.86749 287.454694,7298.39256 C288.087538,7298.63872 288.809936,7298.80547 289.869652,7298.85411 C298.730467,7299.25511 302.015089,7299.03674 303.400182,7295.49028 C303.645956,7294.859 303.815113,7294.1374 303.86188,7293.08031 C304.26686,7284.19677 303.796207,7282.27117 302.251908,7280.72871 C301.027016,7279.50685 299.5862,7278.67508 289.869652,7279.12273 M289.951245,7297.06748 C288.981083,7297.0238 288.454707,7296.86201 288.103459,7296.72603 C287.219865,7296.3826 286.556174,7295.72155 286.214876,7294.84312 C285.623823,7293.32944 285.819846,7286.14023 285.872583,7284.97693 C285.924325,7283.83745 286.155174,7282.79624 286.959165,7281.99226 C287.954203,7280.99968 289.239792,7280.51332 297.993144,7280.90837 C299.135448,7280.95998 300.179243,7281.19026 300.985224,7281.99226 C301.980262,7282.98483 302.473801,7284.28014 302.071806,7292.99991 C302.028024,7293.96767 301.865833,7294.49274 301.729513,7294.84312 C300.829003,7297.15085 298.757333,7297.47145 289.951245,7297.06748 M298.089663,7283.68956 C298.089663,7284.34665 298.623998,7284.88065 299.283709,7284.88065 C299.943419,7284.88065 300.47875,7284.34665 300.47875,7283.68956 C300.47875,7283.03248 299.943419,7282.49847 299.283709,7282.49847 C298.623998,7282.49847 298.089663,7283.03248 298.089663,7283.68956 M288.862673,7288.98792 C288.862673,7291.80286 291.150266,7294.08479 293.972194,7294.08479 C296.794123,7294.08479 299.081716,7291.80286 299.081716,7288.98792 C299.081716,7286.17298 296.794123,7283.89205 293.972194,7283.89205 C291.150266,7283.89205 288.862673,7286.17298 288.862673,7288.98792 M290.655732,7288.98792 C290.655732,7287.16159 292.140329,7285.67967 293.972194,7285.67967 C295.80406,7285.67967 297.288657,7287.16159 297.288657,7288.98792 C297.288657,7290.81525 295.80406,7292.29716 293.972194,7292.29716 C292.140329,7292.29716 290.655732,7290.81525 290.655732,7288.98792"
                                            id="instagram-[#167]"> </path>
                                    </g>
                                </g>
                            </g>
                        </g>
                    </svg>
                </a>
    
            </div>
        </div>
    </div>
<!--     
    
    <div id="cart-overlay">
        <div id="cart-menu">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <h2>Your Cart</h2>
    
                <svg id="close-cart" style="cursor: pointer;" id="close-menu" width="30px" height="30px" viewBox="0 0 24 24"
                    fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7 17L16.9 7.1" stroke="#000" stroke-linecap="round" stroke-linejoin="round"></path>
                    <path d="M7 7L16.9 16.9" stroke="#000" stroke-linecap="round" stroke-linejoin="round"></path>
                </svg>
            </div>
            <div id="cart-items">
                 Dynamic cart items will be inserted here 
            </div>
            <div id="cart-footer">
                <div id="total-price" style="color: green;">Total: GHS 0.00</div>
                <div style="display: flex; justify-content: center; margin-top: 20px;">
                    <a href="{% url 'checkout' %}">
                        <button id="checkout-btn" style="cursor: pointer;">Checkout</button>
                    </a>
                </div>
            </div>
        </div>
    </div> -->

    <div class="checkout-container" style="margin-top: 100px;">
        <!-- Right Side: Cart items -->
        <div class="cart-items">
            <div style="display:flex; justify-content: space-between;align-items: center; margin-bottom: 10px;">
                <h2 style="margin-top: auto; margin-bottom: auto;">Your Cart</h2><img src="{% static 'down.svg' %}"
                    id="down-arrow" alt="down">
            </div>
            <div id="cart-items-container">
                <!-- Cart items will be injected here by JavaScript -->
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center;margin-left: 20px;"
                id="total-price-div">
                <div>Total:</div>
                <div class="total-price" id="total-price" style="color: #28a745; font-weight: bold;"> 0.00</div>
            </div>
        </div>
        <!-- Left Side: Form for customer details -->
        <div class="checkout-form">
            <h2>Personal Details</h2>

            <form id="checkout-form-sub" method="POST" action="/checkout">
                {% csrf_token %}
                <input type="text" id="cartData" name="cartData" hidden>
                <div style="display: flex; justify-content: center; gap: 10px;">
                    <div class="form-floating" style="width: 50%;">
                        <input type="text" class="form-control" id="fname" placeholder="fist name" name="fname"
                            required>
                        <label for="fname">First name</label>
                    </div>
                    <div class="form-floating" style="width: 50%;">
                        <input type="text" class="form-control" id="lname" placeholder="last name" name="lname"
                            required>
                        <label for="lname">Last name</label>
                    </div>
                </div>
                <div class="form-floating mb-3">
                    <input type="email" class="form-control" id="floatingInput" placeholder="name@example.com"
                        name="email" required>
                    <label for="floatingInput">Email address</label>
                </div>
                <div class="form-floating mb-3">
                    <input id="phone" type="tel" name="phone" style="min-width: 100%;" required />
                </div>

                <div class="form-floating">
                    <textarea class="form-control" placeholder="Any Specific delivery instructions."
                        style="height: 140px;" id="floatingTextarea" name="orderNotes"></textarea>
                    <label for="floatingTextarea">Order Notes (optional)</label>
                </div>
                <h2>Delivery Details</h2>
                <div class="form-floating mb-3">
                    <input class="form-control" type="text" id="street-address-1" name="street_address_1" required>
                    <label for="street-address-1">Street Address Line 1:</label>
                </div>

                <div class="form-floating mb-3">
                    <input class="form-control" type="text" id="street-address-2" name="street_address_2">
                    <label for="street-address-2">Street Address Line 2 (optional):</label>
                </div>

                <div class="form-floating mb-3">
                    <input class="form-control" type="text" id="city" name="city" required>
                    <label for="city">City:</label>
                </div>

                <div class="form-floating mb-3">
                    <input class="form-control" type="text" id="state" name="state">
                    <label for="state">State/Province/Region:</label>
                </div>

                <div class="form-floating mb-3">
                    <input class="form-control" type="text" id="zip" name="zip" required>
                    <label for="zip">ZIP/Postal Code:</label>
                </div>
                <div>
                    <select id="destination-country" name="destination_country"
                        style="padding: 10px; margin: 0; padding: 0; width: 50%; background-color: white; border: 1px solid #dddddd;margin-bottom: 10px; color:#6e7073; border-radius: 5px;"
                        required>
                        <option value="" disabled selected style="color: #dddddd;">Select a country</option>
                    </select>

                </div>
                <div class="form-floating" style="color: #6e7073;">
                    <textarea class="form-control" style="height: 140px;"
                        placeholder="Any Specific delivery instructions." id="deliveryInfo"
                        name="deliveryInfo"></textarea>

                    <label>Additional Delivery Information</label>
                </div>
                <div>
                    <input type="number" name="cart-total" id="cart-total-sub" hidden>
                    <input type="text" name="country_code" id="country_code" hidden>
                </div>

                <button  name="pay" id="payButton"
                    style="width:100%;padding:10px;border:none;background-color:#28a745;color:white;font-size:18px;border-radius:5px;">Proceed
                    to pay</button>
            </form>
        </div>


    </div>
    <div class="alert alert-info" style="display: none;"></div>
    <div class="footer-box" style="width: 100%;">
        <div style="display: flex; justify-content: center; gap: 20px; border-top: 1px solid #f0f0f0; padding: 30px;">
            <a href="{% url 'lookbook' %}">
                <div>Lookbook</div>
            </a>
            <a href="{% url 'contact' %}">
                <div>Contact</div>
            </a>
        </div>
        <div style="display: flex; justify-content: space-between; color:#9d9d9d; border-top: 1px solid #f0f0f0; padding: 40px 0px; margin: 0px 10px;">
           <div>
            &copy; GullyBoysClan 2024
           </div>
            <div>
                                <a href="https://www.instagram.com/gullyboysclan/">
                                    <span><svg width="35px" height="35px" viewBox="0 -0.5 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                                            <g id="SVGRepo_iconCarrier">
                                                <path fill-rule="evenodd" clip-rule="evenodd"
                                                    d="M15.5 5H9.5C7.29086 5 5.5 6.79086 5.5 9V15C5.5 17.2091 7.29086 19 9.5 19H15.5C17.7091 19 19.5 17.2091 19.5 15V9C19.5 6.79086 17.7091 5 15.5 5Z"
                                                    stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                                </path>
                                                <path fill-rule="evenodd" clip-rule="evenodd"
                                                    d="M12.5 15C10.8431 15 9.5 13.6569 9.5 12C9.5 10.3431 10.8431 9 12.5 9C14.1569 9 15.5 10.3431 15.5 12C15.5 12.7956 15.1839 13.5587 14.6213 14.1213C14.0587 14.6839 13.2956 15 12.5 15Z"
                                                    stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                                </path>
                                                <rect x="15.5" y="9" width="2" height="2" rx="1" transform="rotate(-90 15.5 9)" fill="#000000">
                                                </rect>
                                                <rect x="16" y="8.5" width="1" height="1" rx="0.5" transform="rotate(-90 16 8.5)" stroke="#000000"
                                                    stroke-linecap="round"></rect>
                                            </g>
                                        </svg></span>
                                </a>

            </div>
        </div>
    </div>


</body>
<script>


    // Fetch countries and populate the select dropdown
    fetch('https://restcountries.com/v3.1/all')
        .then(response => response.json())
        .then(data => {
            // Sort countries alphabetically by their common name
            data.sort((a, b) => a.name.common.localeCompare(b.name.common));

            const select = document.getElementById('destination-country');
            data.forEach(country => {
                const option = document.createElement('option');
                option.value = country.name.common;
                option.textContent = country.name.common;
                select.appendChild(option);
            });
        })
        .catch(error => console.error('Error fetching countries:', error));
</script>

<script>
    down_arrow = document.getElementById('down-arrow')
    cart_div = document.getElementById('cart-items-container')
    total_price_div = document.getElementById('total-price-div')
    down_arrow.onclick = () => {
        if (down_arrow.src.includes('down')) {
            down_arrow.src = '{% static "up.svg" %}'
            cart_div.style.display = 'none'
            total_price_div.style.display = 'none'

        }
        else if (down_arrow.src.includes('up')) {
            down_arrow.src = '{% static "down.svg" %}'
            cart_div.style.display = 'block'
            total_price_div.style.display = 'flex'
        }
    }
</script>
<script>
    const menuBtn = document.getElementById('menu-btn');
    const cartBtn = document.getElementById('cart-btn');
    const closeMenuBtn = document.getElementById('close-menu');
    const closeCartBtn = document.getElementById('close-cart');
    const menu = document.getElementById('menu');
    const overlay = document.getElementById('overlay');

    // Footer buttons


    // Show overlay
    function showOverlay() {
        overlay.style.display = 'block';
    }

    // Hide overlay
    function hideOverlay() {
        overlay.style.display = 'none';
    }

    // Open and close menu
    menuBtn.addEventListener('click', () => {
        menu.classList.add('active');
        showOverlay();
    });

    closeMenuBtn.addEventListener('click', () => {
        menu.classList.remove('active');
        hideOverlay();
    });

    // Open and close cart
    cartBtn.addEventListener('click', () => {
        cart.classList.add('active');
        showOverlay();
    });

    closeCartBtn.addEventListener('click', () => {
        cart.classList.remove('active');
        hideOverlay();
    });



    // Close the sliding menus when the overlay is clicked
    overlay.addEventListener('click', () => {
        menu.classList.remove('active');
        cart.classList.remove('active');
        hideOverlay();
    });
</script>
<script>
       // JavaScript for opening and closing the menu slider
        const menuOverlay = document.getElementById('menu-overlay');
        const menuSlider = document.getElementById('menu-slider');
        const closeMenuButton = document.getElementById('close-menu');

        // Function to open the menu
        function openMenu() {
            menuOverlay.style.display = 'block';
            menuSlider.classList.add('active');
        }

        // Function to close the menu
        function closeMenu() {
            menuSlider.classList.remove('active');
            setTimeout(() => {
                menuOverlay.style.display = 'none';
            }, 300); // Match the transition duration
        }

        // Event listener for closing the menu
        closeMenuButton.addEventListener('click', closeMenu);

        // Event listener for clicking outside the menu slider
        menuOverlay.addEventListener('click', (event) => {
            if (event.target === menuOverlay) {
                closeMenu();
            }
        });

</script>
<!-- Script to handle local storage and cart display -->
<script>
    
    // Function to format the price
    function formatPrice(price) {
        return 'GHS' + price.toFixed(2);
    }

    // Function to render cart items from localStorage
    function renderCartItems() {
            // Retrieve the cart from localStorage
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const cartContainer = document.getElementById('cart-items-container');
            const totalPriceElement = document.getElementById('total-price');
            const payButton = document.getElementById('payButton');
            const cartDataInput = document.getElementById('cartData');
            const totalPriceInput = document.getElementById('cart-total-sub');
            let totalPrice = 0;

            // Disable checkout button if the cart is empty
            if (cart.length === 0) {
                payButton.disabled = true;
                cartContainer.innerHTML = '<p>Your cart is empty.</p>';
                totalPriceElement.textContent = 'Total: GHS 0.00';
                totalPriceInput.value = 0;
                alert('Checkout disabled. Cart is empty.');
                return;
            } else {
                payButton.disabled = false;
            }

            // Set the JSON stringified cart data to the hidden input
            cartDataInput.value = JSON.stringify(cart);

            // Clear existing items
            cartContainer.innerHTML = '';

            // Loop through each item in the cart and render it
            cart.forEach((item, index) => {
                const { name, size, quantity, price, image
                    
                 } = item;
                const itemTotal = price * quantity;
                totalPrice += itemTotal;
                

                // Create a cart item element
                const cartItem = document.createElement('div');
                cartItem.classList.add('cart-item');
                cartItem.innerHTML = `
            <img src="${image}" alt="${name}" style="width: 100px; height: 80px;">
            <div class="cart-item-details">
                <div class="cart-item-name">${name} x${quantity}</div>
                <div class="cart-item-size">Size: ${size}</div>
                <div class="cart-item-price">GHS ${itemTotal.toFixed(2)}</div>
            </div>
        `;

                // Append the cart item to the container
                cartContainer.appendChild(cartItem);
            });

            // Update total price
            totalPriceElement.textContent = `Total: GHS ${totalPrice.toFixed(2)}`;
            totalPriceInput.value = totalPrice.toFixed(2);
        }

        // Initialize the cart items on page load
        window.onload = renderCartItems;

    </script>
<script>
    const phoneInputField = document.querySelector("#phone");

    const phoneInput = window.intlTelInput(phoneInputField, {
        preferredCountries: ["gh"],
        utilsScript:
            "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
    });

</script>
<script>

    country_li = document.querySelectorAll('li.iti__country')
    country_code = document.getElementById('country_code')
    country_code.value = '233'
    country_li.forEach(li => {
        li.onclick = () => {

            country_code.value = li.getAttribute('data-dial-code')
        }
    })

</script>

</html>